<!-- 1. lobby.html -->
<!DOCTYPE html>
<html>
<head>
  <title>Lobi</title>
  <style>
    .table-box { border: 2px solid #000; padding: 10px; margin: 10px; display: inline-block; width: 200px; text-align: center; }
    button { margin: 5px; }
  </style>
</head>
<body>
  <h1>Lobi</h1>
  <div id="tables"></div>

  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
  <script>
    const firebaseConfig = { /* senin configin */ };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const tableIds = ['masa1', 'masa2'];
    const tablesDiv = document.getElementById('tables');

    function createTableElement(roomId, info) {
      const div = document.createElement('div');
      div.className = 'table-box';
      div.innerHTML = `<h3>${roomId}</h3>
        <p>Skor: ${info.score1 || 0} - ${info.score2 || 0}</p>
        <p>SÃ¼re: ${info.minutes || 0} dk</p>
        <button onclick="joinRoom('${roomId}', 'player1')">Player 1 Ol</button>
        <button onclick="joinRoom('${roomId}', 'player2')">Player 2 Ol</button>
        <button onclick="joinRoom('${roomId}', 'viewer')">Izleyici Ol</button>`;
      return div;
    }

    function joinRoom(roomId, role) {
      const target = role === 'viewer' ? 'viewer.html' : 'game.html';
      window.location.href = `${target}?room=${roomId}&role=${role}`;
    }

    function updateLobby() {
      tablesDiv.innerHTML = '';
      tableIds.forEach(id => {
        db.ref('rooms/' + id).once('value', snap => {
          const info = snap.val() || {};
          tablesDiv.appendChild(createTableElement(id, info));
        });
      });
    }
    setInterval(updateLobby, 2000);
  </script>
</body>
</html>
