<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>PingPong Viewer</title>
  <style>canvas{display:block;margin:auto;background:#111}</style>
</head>
<body>
  <canvas id="c" width="900" height="600"></canvas>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js"></script>
  <script>
    // Firebase init (aynı config)
    const app = firebase.initializeApp( /* config */ );
    const db  = firebase.database(app);
    const stateRef = db.ref('game/state');

    const c = document.getElementById('c');
    const ctx = c.getContext('2d');
    const W=c.width, H=c.height;

    let state={ leftY:0, rightY:0, ballX:W/2, ballY:H/2, scoreL:0, scoreR:0 };
    // Dinleyici
    stateRef.on('value', snap=>{
      const v = snap.val();
      if(!v) return;
      state = v;
    });

    function draw(){
      ctx.clearRect(0,0,W,H);
      // orta çizgi
      ctx.strokeStyle='#555'; ctx.setLineDash([10,10]);
      ctx.beginPath();ctx.moveTo(W/2,0);ctx.lineTo(W/2,H);ctx.stroke();
      ctx.setLineDash([]);
      // paddles
      ctx.fillStyle='#fff';
      ctx.fillRect(0, state.leftY,12,85);
      ctx.fillRect(W-12, state.rightY,12,85);
      // top
      ctx.beginPath();
      ctx.arc(state.ballX, state.ballY,10,0,2*Math.PI);
      ctx.fill();
      // skor
      ctx.fillText(`${state.scoreL} – ${state.scoreR}`,W/2-20,30);
      requestAnimationFrame(draw);
    }
    draw();
  </script>
</body>
</html>
