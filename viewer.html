<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Ping Pong Viewer</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <style>
    *{margin:0;padding:0;box-sizing:border-box;}
    body{background:#000;color:#fff;font-family:sans-serif;overflow:hidden;}
    header{display:flex;justify-content:space-between;padding:1rem;}
    .arena{position:relative;margin:auto;width:900px;height:600px;border:3px dashed #fff;}
    .paddle{position:absolute;width:12px;height:85px;background:#fff;}
    #paddle1{left:0;} #paddle2{right:0;}
    .ball{position:absolute;width:15px;height:15px;border-radius:50%;background:#fff;}
    @media(max-width:950px){.arena{width:100%;}}
    /* toast */
    #toast {
      position:fixed;bottom:20px;right:20px;
      background:rgba(0,0,0,0.8);color:#fff;
      padding:1rem 1.5rem;border-radius:5px;
      opacity:0;transition:opacity .4s;
    }
    #toast.show{opacity:1;}
  </style>
  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
</head>
<body>
  <header>
    <div>P1: <strong id="score1">0</strong></div>
    <div style="font-family:monospace;">Ping Pong Viewer</div>
    <div>P2: <strong id="score2">0</strong></div>
  </header>
  <div class="arena" id="arena">
    <div class="paddle" id="paddle1"></div>
    <div class="paddle" id="paddle2"></div>
    <div class="ball"   id="ball"></div>
  </div>
  <div id="toast"></div>

  <script>
  (function(){
    // Firebase init
    const firebaseConfig = {
      apiKey: "AIzaSyASZrCdc3xrJ8iXagE3iMUdhEpPR5FiJOE",
      authDomain: "masa-tenisi-v1.firebaseapp.com",
      databaseURL: "https://masa-tenisi-v1-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "masa-tenisi-v1",
      storageBucket: "masa-tenisi-v1.appspot.com",
      messagingSenderId: "186015084983",
      appId: "1:186015084983:web:86f9d88e907423f5e33832"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const params = new URLSearchParams(location.search);
    const room = params.get('room')||'main';

    // DOM
    const P1= document.getElementById('paddle1'),
          P2= document.getElementById('paddle2'),
          B = document.getElementById('ball'),
          S1= document.getElementById('score1'),
          S2= document.getElementById('score2'),
          toast = document.getElementById('toast');

    function showToast(msg){
      toast.textContent=msg;
      toast.classList.add('show');
      setTimeout(()=>toast.classList.remove('show'),2000);
    }

    // render loop
    db.ref(`rooms/${room}`).on('value', snap=>{
      const st=snap.val();
      if(!st) return;
      P1.style.top=st.p1 + 'px';
      P2.style.top=st.p2 + 'px';
      B.style.left=st.x + 'px';
      B.style.top=st.y + 'px';
      S1.textContent=st.s1;
      S2.textContent=st.s2;
    });
  })();
  </script>
</body>
</html>
